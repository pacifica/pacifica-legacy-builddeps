<?xml version="1.0" encoding="windows-1252"?>
<?define UpgradeCode="04B610B7-0C1B-4821-97B6-FA0ABF648115"?>
<?define Version="@VERSION@"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Name="MyEMSL Builddeps @VERSION@"
		Id="*"
		UpgradeCode="$(var.UpgradeCode)"
		Language="1033"
		Codepage="1252"
		Version="$(var.Version)"
		Manufacturer="MyEMSL Team">
		<Package Id="*"
			Keywords="Installer"
			Description="MyEMSL Builddeps Installer"
			Comments="MyEMSL Builddeps"
			Manufacturer="MyEMSL Team"
			InstallerVersion="300"
			Languages="1033"
			Compressed="yes"
			SummaryCodepage="1252"/>

		<Upgrade Id="$(var.UpgradeCode)">
			<!-- Detect any newer version of this product -->
			<UpgradeVersion
				Minimum="$(var.Version)"
				IncludeMinimum="no"
				OnlyDetect="yes"
				Property="NEWPRODUCTFOUND"/>

			<!-- Detect and remove any version equal to or older than this product -->
			<UpgradeVersion
				Maximum="$(var.Version)"
				IncludeMaximum="yes"
				OnlyDetect="no"
				Property="OLDPRODUCTFOUND"/>
		</Upgrade>

		<Media Id="1"
			Cabinet="myemslbuilddeps.cab"
			EmbedCab="yes"/>

		<Property Id="ALLUSERS" Value="1" />
		
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="SDKDIR" Name="MyEMSLSDK">
				<Component Id="SDKENV"
					Guid="{F66A2B38-1FD5-47B2-8BA5-C82DB784AF8B}">
					<CreateFolder/>
					<Environment Id="MYEMSLSDKENV"
						Action="set"
						Name="MYEMSLSDK"
						Permanent="no"
						System="yes"
						Value="[SDKDIR]"/>
				</Component>
				<Directory Id="BUILDDEPSDIR" Name="builddeps">
				</Directory>
			</Directory>
		</Directory>
		<Feature Id="Complete" Level="1">
			<ComponentRef Id="SDKENV"/>
			<ComponentGroupRef Id="MyEMSLBuilddir"/>
		</Feature>

		<Condition Message="You need to be an administrator to install this package.">Privileged</Condition>

		<!-- Define a custom action --> 
		<CustomAction Id="PreventDowngrading"
			Error="Newer version already installed."/>

		<InstallExecuteSequence>
			<!-- Prevent downgrading -->
			<Custom Action="PreventDowngrading"
				After="FindRelatedProducts">NEWPRODUCTFOUND</Custom>
			<RemoveExistingProducts After="InstallFinalize" />
		</InstallExecuteSequence>

		<InstallUISequence>
			<!-- Prevent downgrading -->
			<Custom Action="PreventDowngrading"
				After="FindRelatedProducts">NEWPRODUCTFOUND</Custom>
		</InstallUISequence>	
	</Product>
</Wix>
